# ファイル修正を検知して環境別ディレクトリにコピーするツール
## ■言語・ツール・開発環境
###### Go/Atom
## ■修正履歴
###### 2016/08/30 公開
###### 2016/10/10 再構成
###### 2016/10/16 コピー設定ファイルをテキストからJSONに変更
## ■紹介
###### 職場で、新規のメール送信タスクに着手するたびに、メール送信用の設定ファイルを作っては10以上の環境別にプロパティファイルを量産（そして一部だけ変更）する必要があり、面倒だったので指定のファイルの修正を検知して勝手に指定のディレクトリ群にコピー（して、指定の内容だけ文字列置換）するツールを作りました。
###### ※「コピーするだけならコマンドプロンプトでも・・・。」とか「頻度的に１回しかないやらないだろうから、ポーリングする意味ないでしょう。」とか、突っ込みどころは満載です。
###### ★バグつぶし足りてないと思います・・・。
## ■作成言語
###### Go です。
###### go build xxxx.go って打つだけで Exe ファイル作ってくれるのが嬉しかったので使ってみました。
###### ほぼワンライナーでポート待ち受けサーバプロセス作れたり、多値を返す関数などは最近の言語では見られる特徴ですが、クラスという概念がない（Cで言う構造体を使う）、そして関数を使う時には、構造体をレシーバとするというのは、Javaから始めた人からすると新鮮。
###### 開発に使ったエディタは Atom ですが、Go 用のプラグインを入れると、恐ろしくコード書きやすいです。
## ■使い方
###### 1. まずサンプルの確認として、WorkGoCopyByEachEnv.zip を解凍して cmd.exe（※）叩いてください。（プロンプト開きます）
###### ※WindowsOS(64bit)用のみ用意（他の環境の場合は要ビルド）
###### 2. ブラウザ開いて、「http://localhost:7109/gopy/start」と打ってください。
###### 　※一回叩いたらブラウザは落としてもいいです。（状況はコンソールが吐きます。）
###### 3. ZIP解凍ディレクトリ内の「_sample」の下に「from」と「to01」、「to02」というディレクトリがあり、「from」の下のプロパティファイルが「to01」、「to02」それぞれにコピーされ、その内容が、同じくZIP解凍ディレクトリ内にある config.json（※コピー時の設定が書かれている） の設定に応じて文字列置換されていることを確認してください。
###### 4. 試しに、「to01」、「to02」のファイルを削除して、「from」の下のプロパティファイルを開いて適当に修正（保存）すると、10秒以内にその修正内容が「to01」、「to02」の下に反映されます。
###### 5. あとは、config.json の中を自分の環境に合わせたパスに変更したり、適宜設定を記述してください。
###### 　（コピーが必要なプロパティファイルが無いなら、そもそも、このプログラムを動かす意味はないです。）
###### 6. 止めたくなったら、ブラウザ開いて、「http://localhost:7109/gopy/end」と打ってください。
###### 　※コンソール上で Ctrl + C でもいいですけど。
###### 　
###### ★コマンドオプション★
###### ・待ち受けポートを変えたい時は、コマンドプロンプトにて「cmd.exe」があるパスに移動し、「cmd.exe -p 9999」（※9999のところを使いたいポートにする）
###### ・コピー元ファイルの変更チェック時間間隔を変えたい時は、コマンドプロンプトにて「cmd.exe」があるパスに移動し、「cmd.exe -s 99」（※99のところをチェックしたい間隔（秒）にする）
## ■その他
###### node.js とのパフォーマンス比較記事がおもしろいです。
###### http://postd.cc/the-way-of-the-gopher/
